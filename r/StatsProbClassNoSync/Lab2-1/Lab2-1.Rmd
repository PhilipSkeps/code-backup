---
title: "Lab 2.1"
output: html_notebook 
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

rm(list = ls()) #clear the workspace
library(mosaic)
library(ggformula)
```

## Introduction

The objectives for this lab are:

  - Create random data that are drawn from both discrete and continuous distributions
  - compare summary statistics to parameter values for the distribution.
  
Make sure you respond to every **TASK**.

# Part 1: Simulating an experiment


You will simulate a sample, drawn from a distribution that models the number of successes counted from *n* trials, each with a success probability *p*.  You will use *n=35* and *p=0.25*. 
Imagine the experiment is rolling a four-side die 35 times, and you create a random variable by counting the number of times a one appears.  

**TASK 1.1** Run the code below to create the sample and view it.  Notice the sample has 50 observations, each of which represents the number of 'successes' from 35 independent trials with P(success)=0.25. and view them.

```{r, echo = F}
mysample <- rbinom(50, size = 35, prob = 0.25)

mysample

```

**TASK 1.2**  Use the code below to create a histogram and a boxplot for the sample.

```{r, echo = F}
gf_histogram(~mysample)
gf_boxplot(~mysample)
```
**TASK 1.3** Describe what you see in these figures.  Mention the range, shape, and apparent 'middle' of your sample.

**Response:** The sample is centered at 8 and ranges from 4 to 14 and is roughly symmetric however it is slightly skewed right.

**TASK 1.4** Use the command `favstats(dataname)` to compute the summary statistics for your sample.

```{r, echo = F}
favstats(mysample)
```
### P(X<13)

Next you use your sample to estimate the probability that the experiment yields fewer than 13 successes.  We do this be calculating the observed proportion of experiments.  

**TASK 1.5**  Run the code below to count how many observations in your sample were less than 13
```{r, echo = F}
sum(mysample<13)
48 / 50
```
**TASK 1.6** Use your work above to calculate the observed P(X<13).

**Response:** P(X<13) = 0.96

 

**TASK 1.7** Run the code below to calculate P(X<13 exactly)

```{r, echo = F}
pbinom(q = 12, size = 35, prob = 0.25) #calculates P(X <= 12), same as P(X<13)
```

**TASK 1.8** Discuss how your estimate for P(X<13) compares to the true value.

**Response:** The estimate P(X<13) seems to overestimate the true probability while remaining within 4 % of the true probability.  

How do you think this estimate for P(X<13) can vary from one sample to another?  Let's try simulating several datasets (five) and comparing the estimates

**TASK 1.9** Run the code below to generate five samples, each in its own column, all with the same premise as your original sample in task 1.1, and calculate the observed probability of how many outcomes are less than 13.
```{r, echo = F}
fivesamples <- data.frame(matrix(rbinom(50*5, size = 35, prob = 0.25), nrow = 50, ncol = 5))

my_prob_13 <- function(x){sum(x<13)/length(x)} # define a function that calculates observed probability for a sample

lapply(fivesamples,my_prob_13) # apply the function and calculate observed probability for each of your five samples

```
```{r, echo = F}
(0.94 + 0.92 + 0.92 + 0.96 + 0.92) / 5
```

**TASK 1.10**  Describe your five estimates for P(X<13).  On average, were they close to the true probability?

**Response:** the average of the five estimates for P(X<13) is 0.932 which is within 0.8% of the true probability.  This is much better than a single estimate which only yielded a probability within 4% of the true probability. 


**TASK 1.11** Use the code below to calculate the sample means for each of your five samples.  Once you run the code, you should use the output and your intuition to make a reasonable guess for the true mean of the random variable X.

**Response:**  The true mean of the random variable is approximately 8.628

```{r, echo = F}
lapply(fivesamples,mean)
```
```{r, echo = F}
(8.16 + 8.56 + 8.66 + 8.8 + 8.96) / 5
```


### Part 2: Simulating from a discrete distribution


Now you will create samples based on a given distribution. The following dataset represents a probability mass function for the number of children born in a population of women. Each row represents a number of children (from 0 to 9) and the probability that a randomly selected woman will have that number of children. Using this dataset, you will generate a random sample, calculate the mean and standard deviation of the sample, create a histogram, and answer questions.

Here is the distribution:

| Number of children, x | P(X = x) |
|:---------------------:|:--------:|
|           0           |   0.29   |
|           1           |   0.16   |
|           2           |   0.22   |
|           3           |   0.15   |
|           4           |   0.08   |
|           5           |   0.04   |
|           6           |   0.02   |
|           7           |   0.02   |
|           8           |   0.01   |
|           9           |   0.01   |


Before we start using simulation to explore this distribution, calculate the mean and standard deviation for X by hand.

**TASK 2.1:** Calculate E[X], showing your work.

**Response** 2

(0)(.29)+(1)(.16)+(2)(.22)+(3)(0.15)+(4)(0.08)+(5)(0.04)+(6)(0.02)+(7)(0.02)+(8)(0.01)+(9)(0.01)


**TASK 2.2:** Calculate Var(X), showing your work.

**Response** 3.82

(0)^2(.29)+(1)^2(.16)+(2)^2(.22)+(3)^2(0.15)+(4)^2(0.08)+(5)^2(0.04)+(6)^2(0.02)+(7)^2(0.02)+(8)^2(0.01)+(9)^2(0.01) - (mu)^2

sd = 1.95

Next we draw a sample that is representative of the population of women, we define a general function that draws a sample of size *n*.  

**TASK 2.3** Run the code below to define the function, and then use the function to draw a sample of size 100.

```{r, echo = F}
sampleDist = function(n){
  sample(x = c(0,1,2,3,4,5,6,7,8,9), n, replace = T, prob = c(.29,.16,.22,.15,.08,.04,.02,.02,.01,.01))
}

sample_100 <- sampleDist(100)  # modify this to generate a sample of size 100 and store it as an object named sample_100
```


**TASK 2.4** Find the mean and standard deviation of your sample of size 100.

```{r, echo = F}

mean(sample_100)
sd(sample_100)

```



**TASK 2.5** Create a histogram for your sample of size 100.

```{r, echo = F}
gf_histogram(~sample_100)
```


Next, create a sample of size 1000 from this distribution, using the formula you defined in 2.3. Name this sample sample_1000.  You will use this sample to understand how estimates from different sample sizes differ.

**TASK 2.6** Create the sample of size 1000, use it calculate the sample mean and sample standard deviation.
```{r, echo = F}

sample_1000 <- sampleDist(1000)

```

**TASK 2.7** Create a histogram of your sample of size 1000.


```{r, echo = F}

gf_histogram(~sample_1000)
mean(sample_1000)
sd(sample_1000)

```


**TASK 2.8** Which sample size better reflects the true mean and standard deviation?  Explain.

**Response:**  The sample size of 1000 gets closer to the true standard deviation and mean values because the sample size is getting closer to the population sample size.

**TASK 2.9** Select which of the options below best completes the statement, and give an explanation for your choice:

If this experiment of drawing two different samples was repeated many times, the sample whose mean, SD, and histogram were closer to the corresponding population values would...

  a. always be the larger samples.
  b. usually, but not always, be the larger sample. <------
  c. be equally likely to be any of the samples.
  d. usually not be the larger sample.
  e. never be the larger sample.
  


# Part 3: Simulating a Continuous Distribution

You will create a set of data that models the number of children in a typical U.S family. A continuous random variable is selected to model this scenario, using probability density function:

$$ f(x) = \frac{1}{3} e^{-\frac{x}{3}}$$,

which has a support of all positive numbers (x>0). 

**TASK 3.1** Create a random sample 500 observations drawn from the distribution using the code below.
```{r, echo = F}
exp_sample <- rexp(500, 1/3)
```

**TASK 3.2** Report the mean and median of x and record them here.
**Response:** The mean of the sample is 2.974 and the median is 2.106

```{r, echo = F}
mean(exp_sample)
median(exp_sample)
```

**TASK 3.3** Compute the population mean and median of this distribution.  Show your work, and if it's too difficult to type, just explain your work in a sentence or two.

**Response:**  The population mean was calculated by integrating the probability density function times the independent variable (x) from zero to infinity and was found to be 3.
The population median was calculated by integrating the probability function from 0 to x then setting that equal to on half. x was then solved for and was found to be 2.079.

**TASK 3.4** Create a histogram of your sample.

```{r, echo = F}
gf_histogram(~exp_sample)
```

**TASK 3.5:**  Does the distribution appear to be skewed? Explain why or why not, using both the histogram and the population mean and median values.

**Response:**  The distribution appears to be skewed right as shown by the histogram above.  Most of the values on the histogram lie in the sub five children region of the chart
while very few families have above 10 children.  No family can have less then zero children therefore the distribution must be skewed right.  The population mean value (3) is also nearly 1 child greater than the median value (2.08) as expected.  This is due to the small number of large families present in the sample and population data described by the pdf.
The mean is much less resistant to skew than the median further providing evidence of the right skewed nature of the population data.








